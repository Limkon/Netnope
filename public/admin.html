<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理使用者 - 原生Node記事本</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header>
        <h1>原生 Node.js 記事本 - 管理員面板</h1>
        <nav>
            <span style="margin-right:20px;">管理員: <strong id="adminUsernameDisplay">{{adminUsername}}</strong></span>
            <a href="/">返回記事列表</a>
            <button id="logoutButton" style="background-color: #d9534f;">登出</button>
        </nav>
    </header>
    <div class="container">
        <h2>使用者管理</h2>

        <div id="adminMessages"></div>

        <h3>新增使用者</h3>
        <form id="addUserForm" style="margin-bottom: 30px; padding: 15px; background-color:#f9f9f9; border-radius:5px;">
            <div>
                <label for="newUsername">使用者名稱:</label>
                <input type="text" id="newUsername" name="username" required>
            </div>
            <div>
                <label for="newPassword">密碼 (普通使用者可為空, 管理員不可):</label>
                <input type="password" id="newPassword" name="password">
            </div>
            <div>
                <label for="newRole">角色:</label>
                <select id="newRole" name="role">
                    <option value="user" selected>普通使用者 (user)</option>
                    <option value="admin">管理員 (admin)</option>
                </select>
            </div>
            <button type="submit">新增使用者</button>
        </form>

        <h3>現有使用者列表</h3>
        <ul id="userList" class="user-list">
            <li>正在載入使用者列表...</li>
        </ul>
    </div>
    <footer>
        <p>&copy; 2025 原生Node記事本。僅供演示。</p>
    </footer>
    <script src="/js/main.js"></script>
    <script>
        const currentAdminUsername = "{{adminUsername}}";
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('adminUsernameDisplay').textContent = currentAdminUsername || 'Admin';
            
            loadUsersForAdmin(); // main.js
            setupAdminUserForm(); // main.js

            const logoutButton = document.getElementById('logoutButton');
            if(logoutButton) {
                logoutButton.addEventListener('click', handleLogout); // main.js
            }
        });
    </script>
</body>
</html>
