- 支持[alwaysdata](https://www.alwaysdata.com/en/)空间一键安装，SSH登陆后执行以下命令，安装完成后在alwaysdata空间设置中找到Command*添加node server.js
     ```bash
     bash <(curl -fsSL https://raw.githubusercontent.com/Limkon/Netnope/master/setup.sh)
     ```

# 咨询分享网站 (Node.js 原生实现)

这是一个完全使用 Node.js 内置模块构建的简单咨询分享Web应用程序，旨在演示如何在不依赖任何第三方NPM包的情况下，从头开始实现一个包含用户认证、数据存储、富文本编辑、文件上传、搜索和评论功能的Web应用。

## 主要功能

* **用户系统**:
    * **多角色:**
        * `member` (会员): 默认注册角色，可以浏览、评论。
        * `consultant` (咨询师): 内容创作者，可以发表、编辑自己的文章。
        * `admin` (管理员): 预设账户 `admin`/`admin`，可以管理用户（指定角色）和所有文章。
    * **认证**: 登录与注册。密码使用加盐哈希 (PBKDF2) 进行加密存储。
    * **管理**:
        * 管理员可以创建、删除和重设任何用户的密码。
        * 管理员不能删除自己或最后一位管理员。
        * 咨询师和管理员修改密码时，新密码不能为空。
* **文章 (Article) 管理**:
    * `consultant` (咨询师) 可以创建、查看、编辑和删除自己的文章。
    * **状态控制**: 文章可保存为 `published` (已发布) 或 `draft` (草稿)。
    * **分类**: 文章可以添加 `category` (分类)。
    * **富文本**: 支持富文本编辑（加粗、斜体、列表、字体、颜色、插入本地图片、链接等）。
    * **附件**: 每篇文章可以附加一个文件。
* **评论 (Comment) 系统**:
    * 登录用户 (`member` 和 `consultant`) 可以对已发布的文章发表评论。
    * 评论作者或 `admin` 可以删除评论。
* **数据存储**:
    * 所有用户、文章、评论数据均以 JSON 格式存储在服务器本地的 `data` 目录中。
    * 上传的附件存储在 `uploads` 目录中，按用户ID分子目录存放。
* **访问控制**:
    * **匿名访问 (`anyone` 用户)**:
        * 管理员可以通过创建/删除名为 `anyone` 的特殊用户来启用/禁用匿名只读访问。
        * 匿名访客可以浏览所有 `published` (已发布) 的文章和评论，但不能进行任何写操作。
    * **会员 (`member`)**: 可以浏览、评论。
    * **咨询师 (`consultant`)**: 可以浏览、评论、管理自己的文章（包括草稿）。
    * **管理员 (`admin`)**: 完全控制所有用户、文章和评论。
* **搜索功能**:
    * 用户可以根据关键字搜索已发布的文章。
    * 搜索会匹配文章的标题、内容（去除HTML）和分类。
* **技术特点**:
    * 完全使用 Node.js 内置模块 (`http`, `fs`, `path`, `url`, `querystring`, `crypto`)。
    * 无任何第三方NPM依赖。
    * 手动实现HTTP路由、会话管理、表单解析（包括`multipart/form-data`）。

## 警告

**此项目主要用于学习和技术演示目的。在生产环境中使用前，需要进行彻底的安全审计和加固。**

主要原因包括但不限于：
* **安全性**：富文本编辑器获取的HTML内容直接存储和渲染，存在XSS风险。
* **健壮性**：手动实现的底层逻辑相比成熟框架，在错误处理和边界情况上可能不够完善。
* **性能考量**：使用同步文件系统操作读写JSON文件作为数据库，在高并发场景下会遇到性能瓶颈。

## 如何运行

1.  **环境准备**:
    * 确保您的系统中已安装 Node.js (建议使用最新的LTS版本)。
2.  **获取代码**:
    * 将项目所有代码文件（`server.js`, `router.js`, `auth.js`, `userController.js`, `articleController.js`, `commentController.js`, `storage.js`, `responseUtils.js`, `public/` 目录及其内容, `package.json`）放置在您本地文件系统的一个新建目录中。
3.  **目录结构确认**:
    (确保 `noteController.js` 已替换为 `articleController.js` 和 `commentController.js`，且 `public/note.html` 和 `public/view-note.html` 已重命名为 `article.html` 和 `view-article.html`)
4.  **启动服务器**:
    * 打开终端，`cd` 进入项目根目录。
    * 运行： `node server.js`
5.  **访问应用**:
    * 在浏览器中打开 `http://localhost:8100` (或您在 `server.js` 中设置的端口)。
6.  **初始管理员账户**:
    * 启动时会自动创建：用户名: `admin` / 密码: `admin`

## 用户与权限 (已更新)

* **管理员 (`admin`)**:
    * 管理所有用户（创建、删除、重设密码、分配角色）。
    * 管理所有文章和评论（查看、编辑、删除）。
    * 通过管理 `anyone` 用户来控制匿名访问。
* **咨询师 (`consultant`)**:
    * 角色由管理员分配。
    * 可以发表、编辑、删除自己的文章（包括草稿和已发布）。
    * 可以发表评论。
* **会员 (`member`)**:
    * 默认注册角色。
    * 可以浏览已发布的文章。
    * 可以发表评论、删除自己的评论。
* **匿名用户 (`anyone` / 访客)**:
    * (如果 `anyone` 用户存在) 可以浏览已发布的文章和评论。
    * 不能进行任何写操作。
