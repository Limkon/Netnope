<%# views/partials/header.ejs %>
<%# 这个 partial 期望被包含在已经有 <html>, <head>, <body> 标签的主模板中 %>
<%# <head> 中的 <link rel="stylesheet" href="/css/style.css"> 等应在主模板中 %>

<header class="navbar">
    <div class="container nav-container">
        <h1><a href="<%= (typeof currentUser !== 'undefined' && currentUser) ? '/notes' : '/auth/login' %>">我的记事本</a></h1>
        <nav style="display: flex; align-items: center;">
            <% if (typeof currentUser !== 'undefined' && currentUser) { %>
                <span style="color: #fff; margin-right: 15px;">欢迎, <%= currentUser.username %> (<%= currentUser.role %>)</span>
                <a href="/notes/new" class="btn btn-sm btn-primary" style="margin-right: 10px;">创建新记事</a>
                <% if (currentUser.role === 'admin') { %>
                    <a href="/admin/users" class="btn btn-sm btn-secondary" style="margin-right: 10px;">用户管理</a>
                <% } %>
                <form action="/auth/logout" method="POST" style="display: inline; margin: 0;">
                    <button type="submit" class="btn btn-sm btn-danger">退出</button>
                </form>
            <% } else { %>
                <%# 根据当前页面标题判断是否显示登录/注册按钮，避免在登录页显示登录按钮等 %>
                <% const currentPath = typeof req !== 'undefined' ? req.path : ''; %>
                <% if (currentPath !== '/auth/login') { %>
                    <a href="/auth/login" class="btn btn-sm btn-light" style="margin-right: 10px;">登录</a>
                <% } %>
                <% if (currentPath !== '/auth/register') { %>
                     <a href="/auth/register" class="btn btn-sm btn-info">注册</a>
                <% } %>
            <% } %>
        </nav>
    </div>
</header>
<main class="container main-content"> <%# 主内容区域开始 %>
